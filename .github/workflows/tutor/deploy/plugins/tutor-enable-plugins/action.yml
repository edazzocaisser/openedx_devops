#------------------------------------------------------------------------------
# written by: mcdaniel
# date: feb-2022
#
# usage: Enable optional Open edX services for deployment to Kubernetes
#------------------------------------------------------------------------------
name: Enable Tutor plugins
description:
branding:
  icon: 'cloud'
  color: 'orange'
inputs:
  environment-id:
    description: 'The Open edX platform environment. Examples: prod, qa, dev'
    required: true
    type: string
  namespace:
    description: 'The Kubernetes namesapce to which the Open edX platform environment will be deployed. Example: openedx-prod'
    required: true
    type: string
  openedx-common-version:
    description: 'The named release of Open edX platform to deploy. Example: open-release/maple.3'
    required: true
    type: string
runs:
  using: "composite"
  steps:
    - name: Enable Tutor Plugins
      uses: ./.github/workflows/tutor/deploy/plugins/tutor-enable-plugin_s3
      with:
        aws-key: ${{ secrets.aws-key }}
        aws-secret: ${{ secrets.aws-secret }}

    - name: Enable the hastexo Backup & Restore plugin
      uses: ./.github/workflows/tutor/deploy/plugins/tutor-enable-plugin-backup

    - name: Enable the Discovery plugin
      uses: ./.github/workflows/tutor/deploy/plugins/tutor-enable-plugin-discovery

    - name: Enable the MFE plugin
      uses: ./.github/workflows/tutor/deploy/plugins/tutor-enable-plugin-mfe

    - name: Enable and configure credentials plugin
      uses: ./.github/workflows/tutor/deploy/plugins/tutor-enable-plugin-credentials

    - name: Enable the Xqueue plugin
      uses: ./.github/workflows/tutor/deploy/plugins/tutor-enable-plugin-xqueue

    - name: Enable the Notes plugin
      uses: ./.github/workflows/tutor/deploy/plugins/tutor-enable-plugin-notes

    - name: Enable and configure ecommerce plugin
      uses: ./.github/workflows/tutor/deploy/plugins/tutor-enable-plugin-ecommerce

    - name: Configure Discussion Forum
      uses: ./.github/workflows/tutor/deploy/plugins/tutor-enable-plugin-forum
